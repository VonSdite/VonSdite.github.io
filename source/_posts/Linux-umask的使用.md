---
title: Linux umask的使用
toc: true
comments: true
categories:
  - Linux
  - Command
tags:
  - Linux
  - Command
  - umask
abbrlink: 11eb8483
date: 2018-12-10 09:46:42
---

# umask

在Linux系统下, 创建一个文件/目录时, 系统都会给它赋予一个默认的权限, 这个默认权限就是`umask`设置的。
`umask`设置了用户创建文件的默认权限, 它与`chmod`的效果刚好相反, `umask`设置的是权限的**反码**, 也叫作**预设权限(权限掩码)**

<!-- more -->
<br>
你的系统管理员必须要为你设置一个合理的 `umask`值, 以确保你创建的文件具有所希望的缺省权限, 防止其他非同组用户对你的文件具有写权限。在已经登录之后, 可以按照个人的偏好使用`umask`命令来改变文件创建的缺省权限。相应的改变**直到退出该shell**或**使用另外的`umask`命令之前**一直有效。

<br>

一般来说, `umask`命令是在`/etc/profile`文件中设置的, 每个用户在登录时都会引用这个文件, 所以如果希望改变所有用户的`umask`, 可以在该文件中加入相应的条目。如果希望永久 性地设置自己的`umask`值, 那么就把它放在自己`$HOME`目录下的`.profile`或`.bash_profile`文件中。

# umask的使用
`umask`命令允许你设定文件创建时的缺省模式, 对应每一类用户(文件属主、同组用户、其他用户)存在一个相应的`umask`值中的数字。

**注意:** 
- **对于文件**来说, 权限数字的**最大值是6**。因为系统不允许你在创建一个文本文件时就赋予**它执行权限**, 必须在创建后用`chmod`命令增加这一权限。
- **目录**允许设置**执行权限**, 这样针对目录来说, `umask`中各个数字最大可以到**7**

## 查看当前umask
```bash
$ umask
0002	             # 只看后四位
$ umask -S
u=rwx,g=rwx,o=rwx	 # 字符形式查看
```

## 设置umask
```bash
umask nnn   # nnn为 000-777
```

![](/images/2018-12-10-10-38-46.png)

## 计算umask的值

设置umask值后, 怎么快速得到创建文件的权限呢

### 减法
一种是使用**减法**。 
记住文件权限最大值是6, 目录权限最大值是7, 
当你`umask 002`, 那么**文件**得到的权限就是 664, 因为 6-0=6 6-0=6 6-2=4, **目录**则是775

### 异或
另一种就是**异或**。
记住文件权限最大值6的二进制是110, 目录权限最大值7的二进制是111, 
当你`umask 002`, 那么**文件**得到的权限就是 664, 因为**二进制异或**: 000^110=110、000^110=110、010^110=100, 所以权限就是664, **目录**则是775